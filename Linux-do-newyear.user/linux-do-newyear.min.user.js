// ==UserScript==
// @name         Linux.do 新春氛围背景
// @namespace    http://tampermonkey.net/
// @version      0.1.0
// @description  为 Linux.do 增加有年味的红金背景与轻量动态效果
// @author       jpzuo
// @match        https://linux.do/*
// @grant        none
// @run-at       document-start
// ==/UserScript==

!function(){"use strict";const n="linuxdo-newyear-style",t="linuxdo-newyear-toggle-style",e="linuxdo_newyear_enabled",i="linuxdo-newyear-toggle",o="linuxdo-newyear-lanterns";function r(t){const e=document.getElementById(n);if(t){if(e)return;const t=document.createElement("style");return t.id=n,t.textContent=`\n:root{\n  --ny-red-1:#4b0000;\n  --ny-red-2:#8b0000;\n  --ny-red-3:#c20f1f;\n  --ny-gold-1:#d4a017;\n  --ny-gold-2:#f5d76e;\n}\n\nhtml, body{\n  background:\n    radial-gradient(circle at 12% 10%, rgba(245,215,110,.18), transparent 28%),\n    radial-gradient(circle at 88% 20%, rgba(212,160,23,.16), transparent 30%),\n    radial-gradient(circle at 50% 108%, rgba(75,0,0,.88), rgba(40,0,0,1) 66%),\n    linear-gradient(145deg, var(--ny-red-1), var(--ny-red-2) 45%, var(--ny-red-3));\n  background-repeat:no-repeat !important;\n}\n\nbody::after{\n  content:"";\n  position:absolute;\n  left:0;\n  right:0;\n  top:0;\n  height:96px;\n  z-index:0;\n  pointer-events:none;\n  background:\n    radial-gradient(circle at 8% -26px, rgba(245,215,110,.26), transparent 40%),\n    radial-gradient(circle at 50% -34px, rgba(245,215,110,.2), transparent 42%),\n    radial-gradient(circle at 92% -26px, rgba(245,215,110,.26), transparent 40%);\n}\n\n.d-header,\n.topic-body,\n.topic-map,\n.topic-post,\n.list-container,\n.navigation-container,\n.sidebar-wrapper,\n.sidebar-container,\n.sidebar-sections,\n.sidebar-custom-sections,\n.sidebar-section-wrapper,\n.sidebar-footer-container,\n.topic-navigation,\n.topic-timeline,\n.timeline-container,\n.user-main .about,\n.category-box,\n.categories-and-latest{\n  background:rgba(255,246,228,.95) !important;\n  border:none !important;\n  box-shadow:none !important;\n}\n\n.topic-timeline .timeline-scrollarea,\n.topic-timeline .timeline-footer-controls,\n.topic-navigation .timeline-container,\n.sidebar-wrapper,\n.sidebar-container,\n.sidebar-section-content,\n.sidebar-footer-wrapper,\n.sidebar-footer-container{\n  background:rgba(255,246,228,.95) !important;\n}\n\na,\n.link-top-line,\n.topic-list .main-link a.title{\n  color:#701010 !important;\n}\n\n.topic-list .main-link a.title,\n.fancy-title,\n.topic-title a{\n  color:#651010 !important;\n  font-weight:600;\n}\n\n#topic-title h1 a,\n.topic-title .fancy-title,\n.title-wrapper .fancy-title{\n  color:#fff1b3 !important;\n  font-weight:700 !important;\n  text-shadow:0 1px 2px rgba(0,0,0,.45);\n}\n\n#topic-title{\n  border-left:none !important;\n  padding-left:10px;\n}\n\n.topic-list .link-bottom-line,\n.topic-excerpt,\n.topic-list .num,\n.topic-list .posters a,\n.names span,\n.badge-notification,\n.category-list .category-description{\n  color:#6e5c49 !important;\n}\n\n.discourse-tag,\n.discourse-tag.box,\n.topic-list .discourse-tags .discourse-tag{\n  color:#7c2600 !important;\n  background:rgba(245, 215, 110, .35) !important;\n  border-color:transparent !important;\n}\n\n.btn-primary,\n.badge-category,\n.nav-pills>li>a.active{\n  background:linear-gradient(145deg, #b50d16, #8e0b12) !important;\n  border-color:#7a090f !important;\n  color:#ffe9b0 !important;\n}\n\n.select-kit.is-expanded .select-kit-options,\n.select-kit-options,\n.select-kit.collection .select-kit-row,\n.d-menu,\n.menu-panel{\n  z-index:12000 !important;\n}\n\n.select-kit.is-expanded{\n  z-index:12000 !important;\n}\n\n.list-container,\n.navigation-container,\n.topic-body,\n.topic-post,\n.topic-map{\n  overflow:visible !important;\n}\n\n#${o}{\n  position:fixed;\n  inset:0;\n  pointer-events:none;\n  z-index:0;\n}\n\n#${o} .ny-lantern{\n  position:fixed;\n  width:42px;\n  height:56px;\n  border-radius:21px 21px 18px 18px;\n  background:\n    linear-gradient(180deg, #d82621 0%, #b31212 70%, #8d0e10 100%);\n  border:1px solid rgba(245,215,110,.75);\n  box-shadow:inset 0 0 0 1px rgba(120,0,0,.35);\n}\n\n#${o} .ny-lantern::before{\n  content:"";\n  position:absolute;\n  left:50%;\n  top:-14px;\n  width:2px;\n  height:14px;\n  transform:translateX(-50%);\n  background:rgba(245,215,110,.85);\n}\n\n#${o} .ny-lantern::after{\n  content:"";\n  position:absolute;\n  left:50%;\n  bottom:-11px;\n  width:2px;\n  height:11px;\n  transform:translateX(-50%);\n  background:rgba(245,215,110,.85);\n}\n\n#${o} .ny-lantern i{\n  position:absolute;\n  left:7px;\n  right:7px;\n  height:1px;\n  background:rgba(245,215,110,.55);\n}\n\n#${o} .ny-lantern i:nth-child(1){ top:16px; }\n#${o} .ny-lantern i:nth-child(2){ top:27px; }\n#${o} .ny-lantern i:nth-child(3){ top:38px; }\n\n#${o} .ny-l-1{ left:12px; top:94px; }\n#${o} .ny-l-2{ left:26px; top:214px; transform:scale(.9); opacity:.95; }\n#${o} .ny-r-1{ right:12px; top:94px; }\n#${o} .ny-r-2{ right:26px; top:214px; transform:scale(.9); opacity:.95; }\n\n@media (max-width: 980px){\n  #${o} .ny-l-2,\n  #${o} .ny-r-2{\n    display:none;\n  }\n}\n`,document.documentElement.appendChild(t),void a(!0)}e&&e.remove(),a(!1)}function a(n){const t=document.getElementById(o);t&&(t.style.display=n?"block":"none")}function d(){!function(){if(document.getElementById(t))return;const n=document.createElement("style");n.id=t,n.textContent=`\n#${i}{\n  position:fixed;\n  right:14px;\n  bottom:14px;\n  z-index:10000;\n  border:none;\n  border-radius:999px;\n  padding:8px 12px;\n  font-size:12px;\n  line-height:1;\n  cursor:pointer;\n  color:#ffe9b0;\n  background:linear-gradient(145deg,#ba1620,#8d0f16);\n  box-shadow:0 6px 16px rgba(0,0,0,.25);\n}\n\n#${i}:hover{\n  filter:brightness(1.06);\n}\n`,document.documentElement.appendChild(n)}(),function(){if(document.getElementById(o))return;const n=document.createElement("div");n.id=o,n.innerHTML='\n<div class="ny-lantern ny-l-1"><i></i><i></i><i></i></div>\n<div class="ny-lantern ny-l-2"><i></i><i></i><i></i></div>\n<div class="ny-lantern ny-r-1"><i></i><i></i><i></i></div>\n<div class="ny-lantern ny-r-2"><i></i><i></i><i></i></div>',document.body.appendChild(n)}(),r("0"!==localStorage.getItem(e)),function(){if(document.getElementById(i))return;const n=document.createElement("button");n.id=i;const t="0"!==localStorage.getItem(e);n.textContent=t?"\u5e74\u5473: \u5f00":"\u5e74\u5473: \u5173",n.addEventListener("click",()=>{const t="0"===localStorage.getItem(e);localStorage.setItem(e,t?"1":"0"),r(t),n.textContent=t?"\u5e74\u5473: \u5f00":"\u5e74\u5473: \u5173"}),document.body.appendChild(n)}()}"loading"===document.readyState?document.addEventListener("DOMContentLoaded",d,{once:!0}):d()}();
